# scProgram
`scProgram` is a R package for quantifying transcriptional programs at the single-cell resolution

## Requirements
    install.packages(c("philentropy","Seurat","data.table","dplyr","tidyverse","Matrix","pheatmap","RColorBrewer","clusterProfiler","ggplot2"))    

## Install
    devtools::install_github("wu-yc/scProgram")

## Quick Start
`scProgram` generally supports the quantification and visualization of transcriptional programs at the single-cell resolution. 

### 1. Load packages and demo data
The demo data is the dataset of Peripheral Blood Mononuclear Cells (PBMC) from 10X Genomics open access dataset (~2,700 single cells, also used by Seurat tutorial). The demo Seurat object can be downloaded from [here](https://figshare.com/articles/dataset/scProgram_-_pbmc_demo_rda/13670038).


    load(file = "pbmc_demo.rda")
    
    library(scProgram)


### 2. Get the features of each cluster
    FeatureMatrix = GetFeatures(obj = countexp.Seurat, group.by = "ident", genenumber = 50, pct_exp = 0.1, mode = "fast")

`obj` is a Seurat object containing the UMI count matrix. 

`group.by` is the cell cluster or identity column of the given Seurat object.

`genenumber` is the number of featured genes of each cluster.

`pct_exp` is the percentage of the gene expressed in each cell cluster.

`mode` supports `fast`, `standard`, in which fast is the default method.



### 3. Plot the heatmap of the features of each cluster
    HeatFeatures(obj = countexp.Seurat, features = FeatureMatrix, group.by = "ident", 
                         show_rownames = F, show_colnames = T, cols = c("white","white", "white", "#52A85F"))

`obj` is a Seurat object containing the UMI count matrix. 

`features` is the output matrix generated by GetFeatures function.

`group.by` is the cell cluster or identity column of the given Seurat object.



### 4. Get the features of each cluster
    GetProgram(features = FeatureMatrix, geneset = "KEGG", pvalue_cutoff = 0.05,
                       cols = c("#F47E5D", "#CA3D74", "#7F2880", "#463873"), plot_term_number =3)


`features` is the output matrix generated by GetFeatures function.

`geneset` supports `KEGG` and `HALLMARK`

`pvalue_cutoff` is the cutoff value for the enrichment analysis.






## Citations
**_scProgram_**


## Author
Ying-Cheng Wu
yingchengwu21@m.fudan.edu.cn

Copyright (C) 2021-2999 Gao Lab @ Fudan University.



